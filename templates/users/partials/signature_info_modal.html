<div
  id="infoModal"
  class="modal"
  style="
    display: none;
    position: fixed;
    z-index: 2000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
  "
>
  <div
    class="modal-content"
    style="
      background: white;
      margin: 10% auto;
      padding: 20px;
      width: 550px;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    "
  >
    <h3 style="margin-top: 0; display: flex; align-items: center; gap: 10px">
      <i class="fas fa-info-circle" style="color: #3182ce"></i>
      <span>Signature Details</span>
    </h3>
    <div
      id="infoContent"
      style="margin-bottom: 20px; max-height: 400px; overflow-y: auto"
    >
      <p>Loading signature information...</p>
    </div>
    <div style="display: flex; justify-content: flex-end">
      <button
        type="button"
        onclick="closeInfoModal()"
        class="btn-submit"
        style="
          margin-top: 0;
          width: auto;
          padding: 8px 20px;
          background: #3182ce;
          color: white;
          border: none;
          border-radius: 4px;
          cursor: pointer;
        "
      >
        Close
      </button>
    </div>
  </div>
</div>

<script>
  function openInfoModal(docId) {
    const modal = document.getElementById("infoModal");
    const content = document.getElementById("infoContent");
    content.innerHTML =
      '<p><i class="fas fa-spinner fa-spin"></i> Loading signature information...</p>';
    modal.style.display = "block";

    fetch(`/signature_info/${docId}/`)
      .then((response) => response.json())
      .then((data) => {
        if (data.signatures && data.signatures.length > 0) {
          let html =
            '<div style="background: #f8fafc; border-radius: 6px; border: 1px solid #e2e8f0;">';
          data.signatures.forEach((sig, index) => {
            html += `
                        <div style="padding: 15px; ${index < data.signatures.length - 1 ? "border-bottom: 1px solid #e2e8f0;" : ""}">
                            <div style="display: grid; grid-template-columns: 100px 1fr; gap: 10px; font-size: 14px;">
                                <span style="font-weight: 600; color: #64748b;">Signer:</span>
                                <span style="color: #1e293b;">${sig.signer}</span>
                                
                                <span style="font-weight: 600; color: #64748b;">Reason:</span>
                                <span style="color: #1e293b;">${sig.reason}</span>
                                
                                <span style="font-weight: 600; color: #64748b;">Date:</span>
                                <span style="color: #1e293b;">${sig.time}</span>
                                
                                <span style="font-weight: 600; color: #64748b;">Field:</span>
                                <span style="color: #1e293b; font-family: monospace;">${sig.field_name}</span>
                            </div>
                        </div>`;
          });
          html += "</div>";
          content.innerHTML = html;
        } else {
          content.innerHTML =
            '<div style="text-align: center; padding: 20px; color: #64748b;"><i class="fas fa-exclamation-triangle fa-2x mb-2"></i><p>No digital signature information found in this document.</p></div>';
        }
      })
      .catch((err) => {
        content.innerHTML =
          '<div style="text-align: center; padding: 20px; color: #ef4444;"><p>Error loading signature information.</p></div>';
      });
  }

  function closeInfoModal() {
    document.getElementById("infoModal").style.display = "none";
  }

  // Close modals when clicking outside
  window.addEventListener("click", function (event) {
    const modal = document.getElementById("infoModal");
    if (event.target === modal) {
      closeInfoModal();
    }
  });
</script>
